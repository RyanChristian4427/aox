HDRS += [ FDirName $(TOP) db ] ;

SubDir TOP db ;
SubInclude TOP server ;

rule PrivilegeList
{
    SCRIPT = [ FDirName $(TOP) schema list-privileges ] ;
    Depends $(<) : $(>) $(SCRIPT) ;
    Clean clean : $(<) ;
    SEARCH on $(>) = schema ;
    MakeLocate $(<) : $(LOCATE_SOURCE) ;
}

actions PrivilegeList bind SCRIPT
{
    perl $(SCRIPT) > $(<) ;
}

PrivilegeList privileges.inc : schema.pg ;

Build database : database.cpp postgres.cpp pgmessage.cpp cachelookup.cpp
    query.cpp transaction.cpp schema.cpp dbsignal.cpp granter.cpp ;

if $(OS) != "OPENBSD" {
    UseLibrary postgres.cpp : crypt ;
}
